
# Code for Hubbard Kanamori model, use AFQMCLAB.

# Check List
- 1 band squre lattice, Hubbard type model
  - 4x3 Up=Dn=5 k=[0.012, 0.034], U=0, U1=0, U2=0, J=0 **PASS**
   
    E_exact = -19.977593664402320428
    
    E_qmc   = -19.977593664402320428
    
    
  - 4x3 Up=Dn=5 k=[0.012, 0.034], U=2, spin decomposition, U1=0, U2=0, J=0 **PASS**
  
    E_exact = -16.35595292025701
        
    E_qmc   = -16.3565(16)  *Nwalker=560, thread=1*
    
    E_qmc   = -16.3569(15)  *Nwalker=70, thread=8*
    
  - 4x3 Up=Dn=5 k=[0.012, 0.034], U=4, spin decomposition, U1=0, U2=0, J=0 **PASS**
  
    E_exact = -13.74240900640183
        
    E_qmc   = -13.7484(39)  *Nwalker=560, thread=1*
    
    E_qmc   = -13.7433(27)  *Nwalker=70, thread=8*
    
  - 4x3 Up=Dn=5 k=[0.012, 0.034], U=-2, charge decomposition, up down conjugate, U1=0, U2=0, J=0 **PASS**
   
    E_exact = -24.72381033684897
     
    E_qmc   = -24.7254(21)         *Nwalker=70, thread=8*   
    
  - 4x3 Up=Dn=5 k=[0.012, 0.034], U=-4, charge decomposition, up down conjugate, U1=0, U2=0, J=0 **PASS**
  
    E_exact = -30.72055193548978
    
    E_qmc   = -30.7117(89)         *Old Hubbard code, Nwalker=300, thread=4*
     
    E_qmc   = -30.7131(55)         *Nwalker=560, thread=1*

    Note: When U is larger, we need BCS trial wave function.
    
  - 4x3 Up=Dn=5 k=[0.012, 0.034], U=2, spin decomposition, U2=0, J=0 **PASS**
  
    Use Nwalker=70, thread=8
  
    |               | E_exact       | E_qmc         |  E_qmc Error   | 
    | ------------- | ------------- | ------------- |  ------------- | 
    | U1=0.5        | -16.00808335  | -16.0082      |  0.0015        | 
    | U1=1.0        | -15.72527770  | -15.7274      |  0.0024        | 
    | U1=1.5        | -15.49655214  | -15.5013      |  0.0040        | 
    | U1=2.0        | -15.31131784  | -15.3139      |  0.0047        | 
    | U1=2.5        | -15.16037404  | -15.1639      |  0.0053        | 

  - 4x3 Up=Dn=5 k=[0.012, 0.034], U=0, charge decomposition, U2=0, J=0, up down conjugate, **PASS**

    Use Nwalker=70, thread=8

    |               | E_exact       | E_qmc         |  E_qmc Error   |
    | ------------- | ------------- | ------------- |  ------------- |
    | U1=-0.5       | -20.36678198  | -20.3658      |  0.0003        |
    | U1=-1.0       | -20.85062234  | -20.8489      |  0.0011        |
    | U1=-1.5       | -21.44578704  | -21.4401      |  0.0023        |
    | U1=-2.0       | -22.17353196  | -22.1647      |  0.0045        |
    | U1=-2.5       | -23.07104818  | -23.0608      |  0.0081        |
    
  - 4x3 Up=Dn=5 k=[0.012, 0.034], U=0, spin decomposition, U1=0, J=0 **PASS**

    Use Nwalker=70, thread=8

    |              | E_exact       | E_qmc         |  E_qmc Error   |
    | -------------| ------------- | ------------- |  ------------- |
    | U2=0.5       | -19.78315000  | -19.7830      |  0.0001        |
    | U2=1.0       | -19.63247504  | -19.6323      |  0.0002        |
    | U2=1.5       | -19.51274846  | -19.5126      |  0.0005        |
    | U2=2.0       | -19.41555849  | -19.4155      |  0.0007        |
    | U2=2.5       | -19.33521684  | -19.3338      |  0.0009        |

  - 4x3 Up=Dn=5 k=[0.012, 0.034], U=0, charge decomposition, U1=0, J=0 **PASS**

    Use Nwalker=70, thread=8

    |               | E_exact       | E_qmc         |  E_qmc Error   |
    | --------------| ------------- | ------------- |  ------------- |
    | U2=-0.5       | -20.23590075  | -20.2365      |  0.0003        |
    | U2=-1.0       | -20.59006416  | -20.5920      |  0.0017        |
    | U2=-1.5       | -21.08977712  | -21.0964      |  0.0048        |
    | U2=-2.0       | -21.80248131  | -21.8142      |  0.0084        |
    | U2=-2.5       | -22.90835556  | -22.8250      |  0.0178        |
    
  - 4x3 Up=Dn=5 k=[0.012, 0.034], U=0, charge decomposition, U1=0, U2=0 **?**

    Use Nwalker=70, thread=8

    |               | E_exact       | E_qmc         |  E_qmc Error   |
    | --------------| ------------- | ------------- |  ------------- |
    | J=0.5         | -19.76361880  | -19.7648      |  0.0013        |
    | J=1.0         | -19.62504811  | -19.5111      |  0.0061        |
    | J=1.5         | -19.56998861  | -18.8844      |  0.0044        |
    | J=2.0         | -19.69625945  | -18.4696      |  0.0051        |
    | J=2.5         | -20.04766280  | -18.3569      |  0.0042        |

  - 4x3 Up=Dn=5 k=[0.012, 0.034], U=0, charge decomposition, U1=0, U2=0 **?**

    Use Nwalker=70, thread=8

    |        | E_exact       |E_qmc-1-sp|  qmc-Error |E_qmc-2-sp| qmc-Error |E_qmc-2-ch|  qmc-Error|
    | -------| ------------- | ---------|  ----------|----------|  ---------|----------|  ---------|
    | J=0.1  | -19.92900277  | -19.9290 |  0.00006   | -19.9290 |  0.00003  | -19.9292 |  0.00003  |
    | J=0.2  | -19.88326444  | -19.8833 |  0.0002    | -19.8833 |  0.00009  | -19.8840 |  0.00008  |
    | J=0.3  | -19.84042638  | -19.8405 |  0.0003    | -19.8404 |  0.0002   | -19.8422 |  0.0002   |
    | J=0.4  | -19.80053154  | -19.8008 |  0.0007    | -19.8005 |  0.0003   | -19.8040 |  0.0003   |
    | J=0.5  | -19.76361880  | -19.7648 |  0.0013    | -19.7637 |  0.0005   | -19.7698 |  0.0005   |
    | J=0.6  | -19.72972395  | -19.7318 |  0.0016    | -19.7291 |  0.0007   | -19.7395 |  0.0008   |
    | J=0.7  | -19.69888137  | -19.7006 |  0.0025    | -19.6971 |  0.0008   | -19.7138 |  0.0009   |
    | J=0.8  | -19.67112638  | -19.6694 |  0.0033    | -19.6640 |  0.0015   | -19.6919 |  0.0008   |
    | J=0.9  | -19.64649872  | -19.6097 |  0.0083    | -19.6164 |  0.0030   | -19.6734 |  0.0016   |
    | J=1.0  | -19.62504811  | -19.5111 |  0.0061    | -19.5574 |  0.0023   | -19.6576 |  0.0020   |
    | J=1.1  | -19.60684320  | -19.3990 |  0.0088    | -19.4850 |  0.0063   | -19.6352 |  0.0031   |
    | J=1.2  | -19.59198754  | -19.2620 |  0.0076    | -19.4235 |  0.0053   | -19.6060 |  0.0041   |
    | J=1.3  | -19.58065006  | -19.1322 |  0.0069    | -19.3546 |  0.0057   | -19.5857 |  0.0049   |
    | J=1.4  | -19.57312808  | -18.9990 |  0.0067    | -19.2810 |  0.0042   | -19.5475 |  0.0068   |
    | J=1.5  | -19.56998861  | -18.8844 |  0.0044    | -19.2043 |  0.0056   | -19.5119 |  0.0073   |
    | J=2.0  | -19.69625945  | -18.4696 |  0.0051    | -18.8321 |  0.0045   | -19.3253 |  0.0067   |
    | J=2.5  | -20.04766280  | -18.3569 |  0.0042    | -18.4631 |  0.0063   | -19.1250 |  0.0056   |

  - 4x3 Up=Dn=5 k=[0.012, 0.034], U=0, U1=0, U2=0 **?**

    Use Nwalker=70, thread=8

    |        | E_exact       |E_qmc_FE-ch| qmc-Error|E_qmc_RHF-sp| qmc-Error|E_qmc_UHF-sp| qmc-Error|
    | -------| ------------- | --------- |----------|----------- | ---------|------------| ---------|
    | J=0.1  | -19.92900277  | -19.9292  | 0.00003  | -19.9290   | 0.000002 | -19.9290   | 0.000002 |
    | J=0.3  | -19.84042638  | -19.8422  | 0.0002   | -19.8404   | 0.00002  | -19.8404   | 0.00002  |
    | J=0.5  | -19.76361880  | -19.7698  | 0.0005   | -19.7635   | 0.00007  | -19.7635   | 0.00007  |
    | J=0.7  | -19.69888137  | -19.7138  | 0.0009   | -19.6983   | 0.0002   | -19.6982   | 0.0002   |
    | J=0.9  | -19.64649872  | -19.6734  | 0.0016   | -19.6434   | 0.0006   | -19.6431   | 0.0006   |
    | J=1.1  | -19.60684320  | -19.6352  | 0.0031   | -19.5944   | 0.0008   | -19.5944   | 0.0012   |
    | J=1.3  | -19.58065006  | -19.5857  | 0.0049   | -19.5596   | 0.0015   | -19.5578   | 0.0021   |
    | J=1.5  | -19.56998861  | -19.5119  | 0.0073   | -19.5333   | 0.0021   | -19.5346   | 0.0020   |
    | J=2.0  | -19.69625945  | -19.3253  | 0.0067   | -19.5907   | 0.0018   | -19.5928   | 0.0012   |
    | J=2.5  | -20.04766280  | -19.1250  | 0.0056   | -19.8882   | 0.0019   | -19.8901   | 0.0020   |

  - 4x3 Up=Dn=5 k=[0.012, 0.034], U=0, U1=0, U2=0 **?**

    Use Nwalker=70, thread=8

    |        | E_exact       |E_qmc_FE-ch| qmc-Error|E_qmc_RHF-sp| qmc-Error|E_qmc_RHF-ch| qmc-Error|
    | -------| ------------- | --------- |----------|----------- | ---------|------------| ---------|
    | J=0.1  | -19.92900277  | -19.9292  | 0.00003  | -19.9290   | 0.000002 | -19.9290   | 0.000002 |
    | J=0.5  | -19.76361880  | -19.7698  | 0.0005   | -19.7635   | 0.00007  | -19.7634   | 0.00008  |
    | J=0.9  | -19.64649872  | -19.6734  | 0.0016   | -19.6434   | 0.0006   | -19.6429   | 0.0004   |
    | J=1.3  | -19.58065006  | -19.5857  | 0.0049   | -19.5596   | 0.0015   | -19.5603   | 0.0009   |
    | J=1.5  | -19.56998861  | -19.5119  | 0.0073   | -19.5333   | 0.0021   | -19.5320   | 0.0013   |
    | J=2.0  | -19.69625945  | -19.3253  | 0.0067   | -19.5907   | 0.0018   | -19.6025   | 0.0016   |
    | J=2.5  | -20.04766280  | -19.1250  | 0.0056   | -19.8882   | 0.0019   | -19.8953   | 0.0030   |


  - 4x3 Up=Dn=5 k=[0.012, 0.034], U=0, charge decomposition, U1=0, U2=0 **?**

    Use Nwalker=70, thread=8

    |               | E_exact       | E_qmc         |  E_qmc Error   |
    | --------------| ------------- | ------------- |  ------------- |
    | J=-0.5        | -20.26131393  | -20.2624      |  0.0010        |
    | J=-1.0        | -20.60651427  | -20.6113      |  0.0017        |
    | J=-1.5        | -21.00325462  | -21.0118      |  0.0043        |
    | J=-2.0        | -21.44173703  | -21.4418      |  0.0056        |
    | J=-2.5        | -21.91348955  | -21.9275      |  0.0058        |




  - 4x3 Up=Dn=5 k=[0.012, 0.034], U=2, U1=1.5, U2=1.0, J=0.5 spin decomposition, RHF trial **PASS**
  
    E_exact = -15.11253446208451
        
    E_qmc   = -15.1187(20)  *Nwalker=70, thread=8*
    
  - 4x2 Up=Dn=5 k=[0.012, 0.034], U=2, U1=1.5, U2=1.0, J=0.5 spin decomposition, RHF trial **PASS**
  
    E_exact = -7.161740881544745
        
    E_qmc   = -7.1625(10)  *Nwalker=70, thread=8*                                                                                          



- 2 band squre lattice, Hubbard type model
  - 5x1 Up=Dn=6 k=0, U=0, U1=0, U2=0, J=0 FE trial **PASS**
   
    E_exact = -12.944271909999165
    
    E_qmc   = -12.944271909999147

  - 5x1 Up=Dn=6 k=0, U varied, U1=0, U2=0, J=0 FE trial **PASS**
  
    Use Nwalker=70, thread=8
  
    |              | E_exact       | E_qmc-FE      |  E_qmc Error   | 
    |------------- | ------------- | ------------- |  ------------- | 
    | U=0          | -12.94427191  | -12.9443      |  0.0000        | 
    | U=0.5        | -11.18073576  | -11.1807      |  0.0001        | 
    | U=1.0        |  -9.48761986  |  -9.4875      |  0.0004        | 
    | U=1.5        |  -7.86103473  |  -7.8601      |  0.0007        | 
    | U=2.0        |  -6.29684119  |  -6.2990      |  0.0011        | 
    | U=2.5        |  -4.79060526  |  -4.7885      |  0.0021        | 
    | U=3.0        |  -3.33763692  |  -3.3390      |  0.0028        |
    | U=3.5        |  -1.93309998  |  -1.9325      |  0.0026        |
            
  - 5x1 Up=Dn=6 k=0, U=0, U1 varied, U2=0, J=0 FE trial **PASS**
  
    Use Nwalker=70, thread=8
  
    |               | E_exact       | E_qmc-FE      |  E_qmc Error   | 
    |-------------- | ------------- | ------------- |  ------------- | 
    | U1=0          | -12.94427191  | -12.9443      |  0.0000        | 
    | U1=0.5        | -11.18073576  | -11.1807      |  0.00006       | 
    | U1=1.0        |  -9.48761986  |  -9.4875      |  0.0004        | 
    | U1=1.5        |  -7.86103473  |  -7.8612      |  0.0006        | 
    | U1=2.0        |  -6.29684119  |  -6.2981      |  0.0017        | 
    | U1=2.5        |  -4.79060526  |  -4.7917      |  0.0016        | 
    | U1=3.0        |  -3.33763692  |  -3.3447      |  0.0031        |
    | U1=3.5        |  -1.93309998  |  -1.9374      |  0.0032        |        
 
  - 5x1 Up=Dn=6 k=0, U=0, U1=0, U2 varied, J=0 FE trial **PASS**
  
    Use Nwalker=70, thread=8
  
    |               | E_exact       | E_qmc-FE      |  E_qmc Error   | 
    |-------------- | ------------- | ------------- |  ------------- | 
    | U2=0          | -12.94427191  | -12.9443      |  0.0000        | 
    | U2=0.5        | -11.18073576  | -11.1807      |  0.0001        | 
    | U2=1.0        |  -9.48761986  |  -9.4869      |  0.0005        | 
    | U2=1.5        |  -7.86103473  |  -7.8601      |  0.0006        | 
    | U2=2.0        |  -6.29684119  |  -6.2966      |  0.0012        | 
    | U2=2.5        |  -4.79060526  |  -4.7880      |  0.0023        | 
    | U2=3.0        |  -3.33763692  |  -3.3379      |  0.0024        |
    | U2=3.5        |  -1.93309998  |  -1.9368      |  0.0039        |      
        
  - 5x1 Up=Dn=6 k=0, U=0, U1=0, U2=0, J varied FE,RHF trial **?**
  
    Use Nwalker=70, thread=8
  
    |              | E_exact       | E_qmc-FE      |  E_qmc Error   | E_qmc-RHF      |  E_qmc Error   | 
    |--------------| ------------- | ------------- |  ------------- |  ------------- |  ------------- | 
    | J=0          | -12.94427191  | -12.9443      |  0.0000        |  -12.9443      |  0.0000        | 
    | J=0.5        | -13.01907867  | -13.0194      |  0.0005        |  -13.0194      |  0.0005        |
    | J=1.0        | -13.25126181  | -13.2393      |  0.0021        |  -13.2393      |  0.0020        |
    | J=1.5        | -13.66430548  | -13.5503      |  0.0052        |  -13.5503      |  0.0051        |
    | J=2.0        | -14.29612229  | -13.8628      |  0.0080        |  -13.9484      |  0.0066        |
    | J=2.5        | -15.18728717  | -14.1228      |  0.0123        |  -14.6270      |  0.0064        |
    | J=3.0        | -16.34796871  | -14.3848      |  0.0191        |  -15.6985      |  0.0108        |
    | J=3.5        | -17.73479395  | -14.6925      |  0.0272        |  -17.1083      |  0.0041        |
    
   - 5x1 Up=Dn=6 k=0, U=0, U1=0, U2=0, J varied RHF,UHF,GHF trial **?**
   
     Use Nwalker=70, thread=8
   
     |       | E_exact       | E_qmc-UHF | E_qmc Error| E_qmc-RHF|E_qmc Error| E_qmc-GHF|E_qmc Error| 
     |-------| ------------- | ----------| ---------- |----------|-----------|----------|-----------|
     | J=0   | -12.94427191  | -12.9443  |  0.0000    | -12.9443 |  0.0000   | -12.9443 |  0.0000   | 
     | J=0.5 | -13.01907867  | -13.0194  |  0.0005    | -13.0194 |  0.0005   | -13.0194 |  0.0005   |
     | J=1.0 | -13.25126181  | -13.2393  |  0.0020    | -13.2393 |  0.0020   | -13.2393 |  0.0021   |
     | J=1.5 | -13.66430548  | -13.5514  |  0.0070    | -13.5539 |  0.0055   | -13.5440 |  0.0043   |
     | J=2.0 | -14.29612229  | -13.9510  |  0.0057    | -13.9538 |  0.0062   | -13.9459 |  0.0064   |
     | J=2.5 | -15.18728717  | -14.6311  |  0.0066    | -14.6155 |  0.0067   | -14.6189 |  0.0061   |
     | J=3.0 | -16.34796871  | -15.7041  |  0.0084    | -15.7200 |  0.0079   | -15.7053 |  0.0094   |
     | J=3.5 | -17.73479395  | -17.1083  |  0.0041    | -17.1151 |  0.0100   | -17.1348 |  0.0115   |

  - 5x1 Up=Dn=6 k=0, U=2, U1=1.5, U2=1.0, J=0.5 FE trial **PASS**
   
     E_exact = 2.3634076153960359
             
     E_qmc   = 2.3672(21)  *Nwalker=70, thread=8*      
     
- 3 band model for Ca2RuO4

  - 1x1x1 Up=Dn=8 U=2.3 J=0.35 T=295K *PASS*
  
    E_exact = 113.4842571775043
   
    E_qmc   = 113.479(12)  *Nwalker=70, thread=8*   

  - 1x1x1 Up=Dn=8 U=2.3 J=0.35 T=400K FE trial *NO*
  
    E_exact = 116.55165572289371
    
    E_qmc   = 116.766(12)  *Nwalker=70, thread=8*  

  - 1x1x1 Up=Dn=8 U=2.3 J=0.35 T=400K GHF trial *PASS*
    
    E_exact = 116.55165572289371
      
    E_qmc   = 116.571(12)  *Nwalker=70, thread=8* 
           
  - 1x1x1 Up=Dn=8 U=2.3 J=0 T=400K FE Trial *?*
  
    E_exact = 134.655974720899
    
    E_qmc   = 134.744(15)  *Nwalker=70, thread=8*      
   
  - 1x1x1 Up=Dn=8 U=2.3 J=0 T=400K GHF Trial *?*
    
    E_exact = 134.655974720899
      
    E_qmc   = 134.7611(36)  *Nwalker=70, thread=8*   
  
  - 1x1x1 Up=Dn=8 U=2.3 J=0 T=400K RHF Trial *?*
      
    E_exact = 134.655974720899
        
    E_qmc   = 134.746(16)  *Nwalker=70, thread=8* 
        
  - 1x1x1 Up=Dn=8 U=2.3 J=0 T=400K UHF Trial *?*
        
    E_exact = 134.655974720899
          
    E_qmc   = 134.725(22)  *Nwalker=70, thread=8*        
             
  - 1x1x1 Up=Dn=8 U=2.3 J=0 T=400K UHF Trial, FE walker *?*
          
    E_exact = 134.655974720899
            
    E_qmc   = 134.709(34)  *Nwalker=70, thread=8* 
                 
  - 1x1x1 Up=Dn=8 U=0 J=0 T=400K *PASS*
 
    E_exact = 78.18490683851658
    
    E_qmc   = 78.18490683851661
          
- U=2, U1=0, U2=0, J=0
  - filling
  - charge
  - spin
- U=-2, U1=0, U2=0, J=0
  - charge
  - spin
  - filling

- U=0, U1=0, U2=0, J=0

- SOC part

New test:
- 1 band squre lattice, Hubbard type model
  - 4x3 Up=Dn=5 k=[0.012, 0.034], U=2, U1=1.5, U2=1.0, J=0.5, RHF trial, RHF initial **PASS**
  
    E_exact = -15.11253446208451
    
    E_qmc   = -15.111(2)  *spinJ, Nwalker=70, thread=8*
        
    E_qmc   = -15.115(2)  *chargeJ, Nwalker=70, thread=8*
    
- 2 band squre lattice, Hubbard type model
  - 5x1 Up=Dn=6 k=0, U=2, U1=1.5, U2=1.0, J=0.5 FE trial **PASS**
   
     E_exact = 2.3634076153960359
             
     E_qmc   = 2.360(2)  *spinJ, Nwalker=70, thread=8* 
     
     E_qmc   = 2.367(2)  *chargeJ, Nwalker=70, thread=8*  
  
  - 5x1 Up=Dn=6 k=0, U=0, U1=0, U2=0, J varied spinJ when J>0, chargeJ when J<0, FE trial **?**
  
    Use Nwalker=70, thread=8
  
    |              | E_exact       | E_qmc-FE      |  E_qmc Error   | 
    |--------------| ------------- | ------------- |  ------------- |  
    | J=0          | -12.94427191  | -12.9443      |  0.0000        | 
    | J=0.5        | -13.01907867  | -13.0190      |  0.0004        |
    | J=-0.5       | -13.01907867  | -13.0192      |  0.0004        | 
    | J=1.0        | -13.25126181  | -13.2541      |  0.0022        |
    | J=-1.0       | -13.25126181  | -13.2547      |  0.0027        | 
    | J=1.5        | -13.66430548  | -13.6939      |  0.0057        |
    | J=-1.5       | -13.66430548  | -13.6903      |  0.0047        | 
    | J=2.0        | -14.29612229  | -14.3652      |  0.0123        | 
    | J=-2.0       | -14.29612229  | -14.3552      |  0.0087        | 
    | J=2.5        | -15.18728717  | -15.3068      |  0.0124        |
    | J=-2.5       | -15.18728717  | -15.2368      |  0.0106        | 
    | J=3.0        | -16.34796871  | -16.5679      |  0.0225        | 
    | J=-3.0       | -16.34796871  | -16.3378      |  0.0142        | 
    | J=3.5        | -17.73479395  | -17.8902      |  0.0222        |  
    | J=-3.5       | -17.73479395  | -17.5896      |  0.0237        |      